{% extends 'base.html' %}

{% block bodydata %}
data-project-id="{{ project.id }}"
data-project-locked="{{ project.islocked }}"
{% endblock %}

{% block title %} | Project: {{ project.name }} - Add new web resource{% endblock %}

{% block main %}
{% include 'snippets/wr_header.html' %}

<div class="container">
    <div class="row">
        <form role="form" id="form" class="col-md-8 col-md-offset-2" method="POST" action="{% url 'geokey_webresources:webresource_add' project.id %}" enctype="multipart/form-data" novalidate>
            {% csrf_token %}

            <h3 class="header">
                {% if project.islocked %}<span class="glyphicon glyphicon-lock text-warning" aria-hidden="true"></span>{% endif %}
                <span>Add new web resource</span>
            </h3>

            <div class="form-group">
                <label for="name" class="control-label">Name (required)</label>
                <input type="text" id="name" class="form-control input-lg" name="name" maxlength="100" required />
            </div>

            <div class="form-group">
                <label for="description" class="control-label">Description</label>
                <textarea id="description" class="form-control input-lg" rows="5" name="description"></textarea>
            </div>

            <div class="form-group">
                <label for="data_format" class="control-label">Data format (required)</label>
                <select id="data_format" class="form-control input-lg" name="data_format" required>
                    <option value="">Please select a value</option>
                    {% for key, value in data_formats %}
                        <option value="{{ key }}">{{ value }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="name" class="control-label">URL (required)</label>
                <input type="url" id="url" class="form-control input-lg" name="url" maxlength="250" required />
            </div>

            <div class="form-group">
                <label for="symbol" class="control-label">Symbol</label>
                <input type="file" id="symbol" name="symbol" data-target="symbol" />
            </div>

            <div class="form-group">
                <button type="submit" class="btn btn-primary">Save</button>
                <a href="{% url 'geokey_webresources:all_webresources' project.id %}" class="btn btn-link" role="button">Cancel</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block libraries %}
<link rel="stylesheet" href="/static/lib/bootstrap-fileinput/css/bootstrap-fileinput.min.css">
<script src="/static/lib/bootstrap-fileinput/js/bootstrap-fileinput.min.js"></script>

<script src="/static/js/admin.ui.forms.validate.js"></script>
<script src="/static/js/admin.ui.fileinput.js"></script>

<script>
// Initialise file upload
$('input:file').each(function() {
    Ui.FileInput.init($(this), {
        showUpload: false,
        showCancel: false
    });
});
</script>
{% endblock %}
